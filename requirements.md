# Glimpse 데이팅 앱 백엔드 시스템 요구사항

## 소개

PostgreSQL과 Spring Boot를 기반으로 한 Glimpse 데이팅 앱의 백엔드 시스템을 구현합니다. 이 시스템은 익명성 보장, 모임 기반 매칭, 실시간 알림을 핵심 기능으로 하며, 확장 가능하고 보안이 강화된 아키텍처를 제공합니다.

## 요구사항

### 요구사항 1: 개발 환경 구성 및 테스트 (우선순위: 높음)

**사용자 스토리:** 개발자로서, 안정적이고 일관된 개발 환경에서 시스템을 구축하고 테스트할 수 있도록 적절한 개발 환경과 테스트 도구를 원합니다.

#### 요구사항 1 수락 기준

1. 개발 환경을 설정할 때 시스템은 Docker를 사용하여 일관된 환경을 제공해야 합니다
2. 데이터베이스 스키마를 관리할 때 시스템은 Flyway를 사용한 마이그레이션을 지원해야 합니다
3. 코드 품질을 보장할 때 시스템은 단위 테스트, 통합 테스트, API 테스트를 포함해야 합니다
4. 개발 중 테스트할 때 시스템은 테스트 데이터베이스와 모킹된 외부 서비스를 제공해야 합니다
5. CI/CD 파이프라인을 구성할 때 시스템은 자동화된 빌드, 테스트, 배포 프로세스를 지원해야 합니다

### 요구사항 2: 사용자 인증 및 관리 (우선순위: 높음)

**사용자 스토리:** 사용자로서, 익명성을 유지하면서 앱에 접근할 수 있도록 전화번호를 사용하여 안전하게 등록하고 인증하고 싶습니다.

#### 요구사항 2 수락 기준

1. 사용자가 전화번호를 제공할 때 시스템은 SMS 인증 코드를 전송해야 합니다
2. 사용자가 유효한 인증 코드를 입력할 때 시스템은 익명 사용자 계정을 생성해야 합니다
3. 사용자가 회사 인증을 선택할 때 시스템은 다음 방법들을 지원해야 합니다: 회사 이메일 도메인 인증, 사원증/학생증 이미지 업로드 및 OCR 검증, 기존 인증된 직원의 초대 코드, HR 관리자의 수동 승인
4. 사용자가 닉네임을 설정할 때 시스템은 해당 그룹 내에서 고유성을 검증해야 합니다
5. 사용자가 이미 인증된 전화번호로 등록을 시도하면 시스템은 중복 계정을 방지해야 합니다
6. 사용자가 로그인할 때 시스템은 적절한 만료 시간을 가진 JWT 토큰을 발급해야 합니다

### 요구사항 3: 모임 생성 및 관리 (우선순위: 높음)

**사용자 스토리:** 사용자로서, 다양한 유형의 그룹을 통해 실제로 아는 사람들과 연결되고 싶습니다.

#### 요구사항 3 수락 기준

1. 시스템이 그룹을 관리할 때 다음 4가지 유형을 지원해야 합니다: 공식 그룹(회사/기관 인증 기반), 생성 그룹(사용자가 직접 생성), 인스턴스 그룹(일회성 이벤트), 장소기반 그룹(특정 위치 기반)
2. 사용자가 회사 인증을 완료할 때 시스템은 해당 공식 그룹에 자동으로 참여시켜야 합니다
3. 사용자가 생성 그룹을 만들 때 시스템은 그룹명, 위치, 최소 참여자 기준을 요구해야 합니다
4. 사용자가 인스턴스 그룹이나 장소기반 그룹에 참여할 때 시스템은 위치 확인이나 대안적인 검증 방법을 제공해야 합니다
5. 그룹의 성별별 참여자가 부족하면 시스템은 매칭 기능을 비활성화해야 합니다
6. 그룹이 최소 기준에 도달하면 시스템은 익명 매칭 기능을 활성화해야 합니다
7. 사용자가 생성 그룹이나 인스턴스 그룹을 떠날 때 시스템은 해당 그룹과 관련된 모든 데이터를 제거해야 합니다
8. 공식 그룹의 경우 사용자가 회사를 떠나거나 인증이 해제될 때만 그룹에서 제거되어야 합니다

### 요구사항 4: 익명 호감 표현 시스템 (우선순위: 높음)

**사용자 스토리:** 사용자로서, 거절이나 당황스러움에 대한 두려움 없이 관심을 표현할 수 있도록 누군가에게 익명으로 호감을 표현하고 싶습니다.

#### 요구사항 4 수락 기준

1. 사용자가 "좋아요"를 보낼 때 시스템은 발신자의 신원을 공개하지 않고 익명으로 기록해야 합니다
2. 사용자가 하루에 1번의 무료 좋아요를 보냈을 때 시스템은 추가 좋아요에 대해 결제를 요구해야 합니다
3. 사용자가 2주 이내에 같은 사람에게 좋아요를 시도하면 시스템은 중복 좋아요를 방지해야 합니다
4. 두 사용자가 서로 좋아요를 보낼 때 시스템은 매치를 생성하고 닉네임을 공개해야 합니다
5. 사용자가 좋아요를 받을 때 시스템은 신원이 아닌 개수만 표시해야 합니다

### 요구사항 5: 채팅 시스템 (우선순위: 중간)

**사용자 스토리:** 매치된 사용자로서, 서로를 더 잘 알 수 있도록 닉네임을 사용하여 채팅하고 싶습니다.

#### 요구사항 5 수락 기준

1. 사용자들이 매치될 때 시스템은 그들 사이에 개인 채팅 채널을 활성화해야 합니다
2. 사용자들이 채팅할 때 시스템은 실제 신원이 아닌 닉네임만 표시해야 합니다
3. 사용자가 부적절한 행동을 신고할 때 시스템은 차단 및 신고 기능을 제공해야 합니다
4. 사용자가 다른 사용자를 차단하면 시스템은 모든 향후 상호작용을 방지해야 합니다
5. 채팅 메시지를 저장할 때 시스템은 모든 메시지 내용을 암호화해야 합니다

### 요구사항 6: 데이터 보안 및 개인정보보호 (우선순위: 높음)

**사용자 스토리:** 사용자로서, 개인정보 보호에 대한 우려 없이 앱을 사용할 수 있도록 개인 정보와 상호작용이 완전히 안전하고 익명이기를 원합니다.

#### 요구사항 6 수락 기준

1. 사용자 데이터를 저장할 때 시스템은 모든 개인 식별 정보를 암호화해야 합니다
2. 좋아요와 매치를 처리할 때 시스템은 익명 식별자만 사용해야 합니다
3. 사용자가 계정을 삭제하면 시스템은 모든 개인 데이터를 영구적으로 제거해야 합니다
4. 데이터베이스에 접근할 때 시스템은 암호화된 연결과 적절한 인증을 사용해야 합니다
5. 시스템 이벤트를 로깅할 때 시스템은 개인 식별 정보를 포함해서는 안 됩니다

### 요구사항 7: 실시간 알림 시스템 (우선순위: 중간)

**사용자 스토리:** 사용자로서, 앱에 계속 참여할 수 있도록 좋아요와 매치에 대한 실시간 알림을 받고 싶습니다.

#### 요구사항 7 수락 기준

1. 사용자가 좋아요를 받을 때 시스템은 업데이트된 개수와 함께 푸시 알림을 보내야 합니다
2. 매치가 발생할 때 시스템은 즉시 두 사용자 모두에게 알림을 보내야 합니다
3. 시스템이 알림을 보낼 때 발신자에 대한 식별 정보를 공개해서는 안 됩니다
4. 사용자가 알림을 비활성화했다면 시스템은 그들의 선택을 존중해야 합니다
5. 알림을 보낼 때 시스템은 배터리 수명과 네트워크 효율성을 최적화해야 합니다

### 요구사항 8: 결제 시스템 통합 (우선순위: 낮음)

**사용자 스토리:** 사용자로서, 앱에서의 경험을 향상시킬 수 있도록 추가 좋아요나 프리미엄 기능을 구매하고 싶습니다.

#### 요구사항 8 수락 기준

1. 사용자가 추가 좋아요를 구매할 때 시스템은 결제를 안전하게 처리하고 잔액을 업데이트해야 합니다
2. 사용자가 프리미엄 기능을 구독할 때 시스템은 구독 상태와 갱신을 관리해야 합니다
3. 결제가 실패하면 시스템은 오류를 우아하게 처리하고 사용자에게 알려야 합니다
4. 결제를 처리할 때 시스템은 PCI DSS 표준을 준수해야 합니다
5. 사용자가 구독을 취소할 때 시스템은 약관에 따라 취소를 처리해야 합니다

### 요구사항 9: 관리자 도구 및 모니터링 (우선순위: 중간)

**사용자 스토리:** 관리자로서, 안전하고 기능적인 플랫폼을 유지할 수 있도록 시스템 상태를 모니터링하고 사용자 신고를 관리하고 싶습니다.

#### 요구사항 9 수락 기준

1. 관리자가 시스템에 접근할 때 안전한 인증과 역할 기반 접근 권한을 가져야 합니다
2. 사용자가 부적절한 행동을 신고할 때 관리자는 조사하고 조치를 취할 수 있는 도구를 가져야 합니다
3. 시스템 성능이 저하될 때 모니터링 시스템은 관리자에게 경고해야 합니다
4. 의심스러운 활동이 감지되면 시스템은 자동으로 검토를 위해 플래그를 지정해야 합니다
5. 보고서를 생성할 때 시스템은 사용자 익명성을 유지하면서 분석을 제공해야 합니다

## 그룹 유형 상세 정의

### 공식 그룹 (Official Group)

- 회사, 대학교, 종교단체 등 공식 기관에서 인증된 그룹
- 인증 방법:
  - 회사 이메일 도메인 자동 인증 (예: @company.com)
  - 사원증/학생증 OCR 인증 (이름, 소속, 유효기간 확인)
  - 기존 인증 멤버의 초대 코드 시스템
  - HR/관리자의 수동 승인 프로세스
- 인증 완료 시 해당 기관의 공식 그룹에 자동 참여
- 퇴사/졸업 시 자동 그룹 제거 (정기적 인증 상태 확인)

### 생성 그룹 (Created Group)

- 사용자가 직접 생성하는 그룹 (동호회, 스터디 그룹 등)
- 그룹 생성자가 관리자 역할 수행
- 참여 승인 프로세스 포함

### 인스턴스 그룹 (Instance Group)

- 일회성 이벤트나 모임을 위한 임시 그룹
- 특정 날짜/시간에 자동 해제
- 이벤트 종료 후 데이터 정리

### 장소기반 그룹 (Location-based Group)

- 특정 위치(카페, 도서관, 공원 등)에 기반한 그룹
- GPS 또는 QR코드를 통한 위치 인증
- 해당 장소에 있을 때만 활성화

## 회사 인증 시스템 고려사항

### 보안 및 검증

- 이메일 도메인 화이트리스트 관리 (스팸 도메인 차단)
- OCR 결과의 위조 방지를 위한 이미지 메타데이터 검증
- 초대 코드의 일회성 및 만료 시간 관리
- 인증 시도 횟수 제한 (무차별 대입 공격 방지)

### 개인정보보호

- 사원증 이미지는 인증 후 즉시 삭제 (필요한 정보만 추출 후 폐기)
- 회사 정보는 그룹 매칭에만 사용, 개인 식별에는 미사용
- 퇴사자 정보의 자동 정리 및 익명화

### 확장성

- 새로운 회사/기관 추가 시 관리자 도구 제공
- 대기업의 부서별 세분화 그룹 지원
- 다국적 기업의 지역별 그룹 관리
